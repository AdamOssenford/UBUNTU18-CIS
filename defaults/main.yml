---
# If you would like a report at the end accordin to OpenSCAP as to the report results
# then you should set ubtu18cis_oscap_scan to true/yes.
# NOTE: This requires the python_xmltojson package on the control host.
ubtu18cis_oscap_scan: no
ubtu18cis_report_dir: /tmp

ubtu18cis_section1_patch: true
ubtu18cis_section2_patch: true
ubtu18cis_section3_patch: true
ubtu18cis_section4_patch: true
ubtu18cis_section5_patch: true
ubtu18cis_section6_patch: true

# We've defined complexity-high to mean that we cannot automatically remediate
# the rule in question.  In the future this might mean that the remediation
# may fail in some cases.
ubtu18cis_complexity_high: false

# Show "changed" for complex items not remediated per complexity-high setting
# to make them stand out.  "changed" items on a second run of the role would
# indicate items requiring manual review.
ubtu18cis_audit_complex: true

# We've defined disruption-high to indicate items that are likely to cause
# disruption in a normal workflow.  These items can be remediated automatically
# but are disabled by default to avoid disruption.
ubtu18cis_disruption_high: true

# Show "changed" for disruptive items not remediated per disruption-high
# setting to make them stand out.
ubtu18cis_audit_disruptive: yes

ubtu18cis_skip_for_travis: false

ubtu18cis_workaround_for_disa_benchmark: true
ubtu18cis_workaround_for_ssg_benchmark: true

# tweak role to run in a chroot, such as in kickstart %post script
ubtu18cis_system_is_chroot: "{{ ansible_is_chroot | default(False) }}"

# tweak role to run in a non-privileged container
ubtu18cis_system_is_container: false

# Section 1 Fixes
# Section 1 is Iniitial setup (FileSystem Configuration, Configure Software Updates, Configure sudo, Filesystem Integrity Checking, Secure Boot Settings,
# Additional Process Hardening, Mandatory Access Control, and Warning Banners)
ubtu18cis_rule_1_1_1_1: true
ubtu18cis_rule_1_1_1_2: true
ubtu18cis_rule_1_1_1_3: true
ubtu18cis_rule_1_1_1_4: true
ubtu18cis_rule_1_1_1_5: true
ubtu18cis_rule_1_1_1_6: true
ubtu18cis_rule_1_1_1_7: true
ubtu18cis_rule_1_1_1_8: true
ubtu18cis_rule_1_1_1: true
ubtu18cis_rule_1_1_2: true
ubtu18cis_rule_1_1_3: true
ubtu18cis_rule_1_1_4: true
ubtu18cis_rule_1_1_5: true
ubtu18cis_rule_1_1_6: true
ubtu18cis_rule_1_1_7: true
ubtu18cis_rule_1_1_8: true
ubtu18cis_rule_1_1_9: true
ubtu18cis_rule_1_1_10: true
ubtu18cis_rule_1_1_11: true
ubtu18cis_rule_1_1_12: true
ubtu18cis_rule_1_1_13: true
ubtu18cis_rule_1_1_14: true
ubtu18cis_rule_1_1_15: true
ubtu18cis_rule_1_1_16: true
ubtu18cis_rule_1_1_17: true
ubtu18cis_rule_1_1_18: true
ubtu18cis_rule_1_1_19: true
ubtu18cis_rule_1_1_20: true
ubtu18cis_rule_1_1_21: true
ubtu18cis_rule_1_1_22: true
ubtu18cis_rule_1_1_23: true
ubtu18cis_rule_1_2_1: true
ubtu18cis_rule_1_2_2: true
ubtu18cis_rule_1_3_1: true
ubtu18cis_rule_1_3_2: true
ubtu18cis_rule_1_3_3: true
ubtu18cis_rule_1_4_1: true
ubtu18cis_rule_1_4_2: true
ubtu18cis_rule_1_5_1: true
ubtu18cis_rule_1_5_2: true
ubtu18cis_rule_1_5_3: true
ubtu18cis_rule_1_5_4: true
ubtu18cis_rule_1_6_1: true
ubtu18cis_rule_1_6_2: true
ubtu18cis_rule_1_6_3: true
ubtu18cis_rule_1_6_4: true
ubtu18cis_rule_1_7_1_1: false
ubtu18cis_rule_1_7_1_2: false
ubtu18cis_rule_1_7_1_3: false
ubtu18cis_rule_1_7_1_4: false
ubtu18cis_rule_1_8_1_1: true
ubtu18cis_rule_1_8_1_2: true
ubtu18cis_rule_1_8_1_3: true
ubtu18cis_rule_1_8_1_4: true
ubtu18cis_rule_1_8_1_5: true
ubtu18cis_rule_1_8_1_6: true
ubtu18cis_rule_1_8_2: true
ubtu18cis_rule_1_9: true

# Section 2 Fixes
# Section 2 is Services (inetd, special purpose, and service clients)
ubtu18cis_rule_2_1_1: true
ubtu18cis_rule_2_1_2: true
ubtu18cis_rule_2_2_1_1: true
ubtu18cis_rule_2_2_1_2: true
ubtu18cis_rule_2_2_1_3: true
ubtu18cis_rule_2_2_1_4: true
ubtu18cis_rule_2_2_2: true
ubtu18cis_rule_2_2_3: true
ubtu18cis_rule_2_2_4: true
ubtu18cis_rule_2_2_5: true
ubtu18cis_rule_2_2_6: true
ubtu18cis_rule_2_2_7: true
ubtu18cis_rule_2_2_8: true
ubtu18cis_rule_2_2_9: true
ubtu18cis_rule_2_2_10: true
ubtu18cis_rule_2_2_11: true
ubtu18cis_rule_2_2_12: true
ubtu18cis_rule_2_2_13: true
ubtu18cis_rule_2_2_14: true
ubtu18cis_rule_2_2_15: true
ubtu18cis_rule_2_2_16: true
ubtu18cis_rule_2_2_17: true
ubtu18cis_rule_2_3_1: true
ubtu18cis_rule_2_3_2: true
ubtu18cis_rule_2_3_3: true
ubtu18cis_rule_2_3_4: true
ubtu18cis_rule_2_3_5: true

# Section 3 Fixes
# Section 3 is Network Configuration (network parameters(host), network parameters (host and router), tcp rappers, uncommon network protocols, and firewall configuration)
ubtu18cis_rule_3_1_1: true
ubtu18cis_rule_3_1_2: true
ubtu18cis_rule_3_2_1: true
ubtu18cis_rule_3_2_2: true
ubtu18cis_rule_3_2_3: true
ubtu18cis_rule_3_2_4: true
ubtu18cis_rule_3_2_5: true
ubtu18cis_rule_3_2_6: true
ubtu18cis_rule_3_2_7: true
ubtu18cis_rule_3_2_8: true
ubtu18cis_rule_3_2_9: true
ubtu18cis_rule_3_3_1: true
ubtu18cis_rule_3_3_2: true
ubtu18cis_rule_3_3_3: true
ubtu18cis_rule_3_3_4: true
ubtu18cis_rule_3_3_5: true
ubtu18cis_rule_3_4_1: true
ubtu18cis_rule_3_4_2: true
ubtu18cis_rule_3_4_3: true
ubtu18cis_rule_3_4_4: true
ubtu18cis_rule_3_5_1_1: true
ubtu18cis_rule_3_5_2_1: true
ubtu18cis_rule_3_5_2_2: true
ubtu18cis_rule_3_5_2_3: true
ubtu18cis_rule_3_5_2_4: true
ubtu18cis_rule_3_5_2_5: true
ubtu18cis_rule_3_5_3_1: true
ubtu18cis_rule_3_5_3_2: true
ubtu18cis_rule_3_5_3_3: true
ubtu18cis_rule_3_5_3_4: true
ubtu18cis_rule_3_5_3_5: true
ubtu18cis_rule_3_5_3_6: true
ubtu18cis_rule_3_5_3_7: true
ubtu18cis_rule_3_5_3_8: true
ubtu18cis_rule_3_5_4_1_1: true
ubtu18cis_rule_3_5_4_1_2: true
ubtu18cis_rule_3_5_4_1_3: true
ubtu18cis_rule_3_5_4_1_4: true
ubtu18cis_rule_3_5_4_2_1: true
ubtu18cis_rule_3_5_4_2_2: true
ubtu18cis_rule_3_5_4_2_3: true
ubtu18cis_rule_3_5_4_2_4: true
ubtu18cis_rule_3_6: true
ubtu18cis_rule_3_7: true

# Section 4 Fixes
# Section 4 is Logging and Auditing (configure system accounting and configure logging)
ubtu18cis_rule_4_1_1_1: true
ubtu18cis_rule_4_1_1_2: true
ubtu18cis_rule_4_1_1_3: true
ubtu18cis_rule_4_1_1_4: true
ubtu18cis_rule_4_1_2_1: true
ubtu18cis_rule_4_1_2_2: true
ubtu18cis_rule_4_1_2_3: true
ubtu18cis_rule_4_1_3: true
ubtu18cis_rule_4_1_4: true
ubtu18cis_rule_4_1_5: true
ubtu18cis_rule_4_1_6: true
ubtu18cis_rule_4_1_7: true
ubtu18cis_rule_4_1_8: true
ubtu18cis_rule_4_1_9: true
ubtu18cis_rule_4_1_10: true
ubtu18cis_rule_4_1_11: true
ubtu18cis_rule_4_1_12: true
ubtu18cis_rule_4_1_13: true
ubtu18cis_rule_4_1_14: true
ubtu18cis_rule_4_1_15: true
ubtu18cis_rule_4_1_16: true
ubtu18cis_rule_4_1_17: true
ubtu18cis_rule_4_2_1_1: true
ubtu18cis_rule_4_2_1_2: true
ubtu18cis_rule_4_2_1_3: true
ubtu18cis_rule_4_2_1_4: true
ubtu18cis_rule_4_2_1_5: true
ubtu18cis_rule_4_2_1_6: true
ubtu18cis_rule_4_2_2_1: true
ubtu18cis_rule_4_2_2_2: true
ubtu18cis_rule_4_2_2_3: true
ubtu18cis_rule_4_2_3: true
ubtu18cis_rule_4_3: true

# Service configuration variables, set to true to keep service
ubtu18cis_allow_autofs: false
ubtu18cis_allow_usb_storage: false
ubtu18cis_avahi_server: false
ubtu18cis_cups_server: false
ubtu18cis_dhcp_server: false
ubtu18cis_ldap_server: false
ubtu18cis_nfs_rpc_server: false
ubtu18cis_dns_server: false
ubtu18cis_vsftpd_server: false
ubtu18cis_httpd_server: false
ubtu18cis_dovecot_server: false
ubtu18cis_smb_server: false
ubtu18cis_squid_server: false
ubtu18cis_snmp_server: false
ubtu18cis_rsync_server: false
ubtu18cis_nis_server: false

# Clients in use variables
ubtu18cis_nis_required: false
ubtu18cis_rsh_required: false
ubtu18cis_talk_required: false
ubtu18cis_telnet_required: false
ubtu18cis_ldap_clients_required: false
ubtu18cis_is_router: false

# IPv6 requirement toggle
ubtu18cis_ipv6_required: false

# Other system wide variables
# ubtu18cis_xwindows_required is the toggle for requiring x windows. True means you use X Windoes (not recommented for servers)
# false means you do not require X Windows enabled
ubtu18cis_xwindows_required: false
# Section 1 Control Variables
# Control 1.1.2/1.1.3/1.1.4/1.1.5
# ubtu18cis_tmp_fstab_options are the file system options for the fstabs configuration
# To conform to CIS cotnrol 1.1.2 could use any settings
# To conform to CIS control 1.1.3 nodev needs to be present
# To conform to CIS control 1.1.4 nosuid needs to be present
# To conform to CIS control 1.1.5 noexec needs to present
ubtu18cis_tmp_fstab_options: "defaults,rw,nosuid,nodev,noexec,relatime"

# Control 1.1.8/1.1.9/1.1.10
# These are the settings for the /var/tmp mount
# To conform to CIS control 1.1.8 nodev needs to be present in opts
# To conform to CIS control 1.1.9 nosuid needs to be present in opts
# To conform to CIS control 1.1.10 noexec needs to be present in opts
ubtu18cis_vartmp:
    source: /tmp
    fstype: none
    opts: "defaults,nodev,nosuid,noexec,bind"
    enabled: no

# Control 1.3.1
# ubtu18cis_sudo_package is the name of the sudo package to install
# The possible values are "sudo" or "sudo-ldap"
ubtu18cis_sudo_package: "sudo"

# Control 1.3.3
# ubtu18cis_sudo_logfile is the path and file name of the sudo log file
ubtu18cis_sudo_logfile: "/var/log/sudo.log"

# Control 1.4.2
# These are the crontab settings for file system integrity enforcement
ubtu18cis_aide_cron:
    cron_user: root
    cron_file: /etc/crontab
    aide_job: '/usr/bin/aide.wrapper --config /etc/aide/aide.conf --check'
    aide_minute: 0
    aide_hour: 5
    aide_day: '*'
    aide_month: '*'
    aide_weekday: '*'

# Control 1.5.2
ubtu18cis_bootloader_password: random
rhel7cis_set_boot_pass: false

# Control 1.5.
# THIS VARAIBLE SHOULD BE CHANGED AND INCORPROATED INTO VAULT
# THIS VALUE IS WHAT THE ROOT PW WILL BECOME!!!!!!!!
# HAVING THAT PW EXPOSED IN RAW TEXT IS NOT SECURE!!!!
ubtu18cis_root_pw: "Password1"

# Control 1.8.1.1
# This will be the motd banner must not contain the below items in order to be compliant with Ubuntu 18 CIS
# \m, \r, \s, \v or references to the OS platform
ubtu18cis_warning_banner: |
        Authorized uses only. All activity may be monitored and reported.

# Section 2 Control Variables
# Control 2.2.1.1
# ubtu18cis_time_sync_tool is the tool in which to synchronize time
# The two options are chrony or ntp
ubtu18cis_time_sync_tool: "ntp"

# Control 2.2.1.3
# ubtu18cis_chrony_server_options is the server options for chrony
ubtu18cis_chrony_server_options: "minpoll 8"
# ubtu18cis_ntp_server_options is the server options for ntp
ubtu18cis_ntp_server_options: "iburst"
# ubtu18cis_time_synchronization_servers are the synchronization servers
ubtu18cis_time_synchronization_servers:
    - 0.pool.ntp.org
    - 1.pool.ntp.org
    - 2.pool.ntp.org
    - 3.pool.ntp.org

# Section 3 Control Variables
# Control 3.3.2
# values for the /etc/hosts.allow file for IP addresses permitted to connect to the host. 
ubtu18cis_host_allow:
    - "10.0.0.0/255.0.0.0"
    - "172.16.0.0/255.240.0.0"
    - "192.168.0.0/255.255.0.0"

# Control 3.5.1.1
# ubtu18cis_firewall_package is the firewall package you will be using.
# the options are ufw, nftables, or iptables
# you much chose only one firewall package
ubtu18cis_firewall_package: "ufw"
# ubtu18cis_iptables_v6 toggles iptables vs ip6tables CIS firewall rules and is used with 
# variable ubtu18cis_firewall_package set to iptables
ubtu18cis_iptables_v6: true

# Controls 3.5.4.1.1 through 3.5.4.1.4
# The iptables module only writes to memory which means a reboot could revert settings
# The below toggle will install iptables-persistent and save the rules in memory (/etc/iptables/rules.v4 or rules.v6)
# This makes the CIS role changes permenant
ubtu18cis_save_iptables_cis_rules: true

# Control 3.5.2.4
# ubtu18cis_ufw_allow_out_ports are the ports for the firewall to allow
# if you want to allow out on all ports set variable to "all", example ubtu18cis_ufw_allow_out_ports: "all"
ubtu18cis_ufw_allow_out_ports: 
    - 53
    - 80
    - 443

# Control 3.5.3.2
# ubtu18cis_nftables_table_name is the name of the table in nftables you want to create
# the default nftables table name is inet filter. This variable name will be the one all
# nftables configs are applied to
ubtu18cis_nftables_table_name: "inet filter"

# Section 4 Control Variables
# Control 4.1.1.4
# ubtu18cis_audit_back_log_limit is the audit_back_log limit and should be set to a sufficient value
# The example from CIS uses 8192
ubtu18cis_audit_back_log_limit: 8192

# Control 4.1.2.1
# ubtu18cis_max_log_file_size is largest the log file will become in MB
# This shoudl be set based on your sites policy
ubtu18cis_max_log_file_size: 10

# Control 4.1.2.2
ubtu18cis_auditd:
    admin_space_left_action: halt
    max_log_file_action: keep_logs

# Control 4.2.1.3
# ubtu18cis_rsyslog_ansible_managed will toggle ansible automated configurations of rsyslog
# You should set the rsyslog to your side specific needs. This toggle will use the example from 
# page 347 to set rsyslog loggin based on those configuration suggestions. Settings can be seen 
# in control 4.2.1.3
ubtu18cis_rsyslog_ansible_managed: true

# Control 4.2.1.5
# ubtu18cis_remote_log_server is the remote logging server
ubtu18cis_remote_log_server: 192.168.2.100

# Control 4.2.1.6
ubtu18cis_system_is_log_server: true